Plocka data från hemsida
import requests

#unicef data med api nyckel sdmx(RAW DATA)
url = "https://sdmx.data.unicef.org/ws/public/sdmxapi/rest/data/UNICEF,MNCH,1.0/.MNCH_PNEUCARE._T......?startPeriod=2014&endPeriod=2024&format=csv&labels=name"

#hämtar med requests.get
response = requests.get(url)

#kollar om requesten gick igenom och sparar csv filen
if response.status_code == 200:
   
    with open("unicef_pneumonia_data.csv", "wb") as file:
        file.write(response.content)
    print("CSV file has been downloaded successfully.")
else:
    print(f"Error: {response.status_code} - {response.text}")



#KOD FÖR ATT LÄGGA IN SYDOSTASIATISKA OCH AFRIKANSKA LÄNDERS AMNING OCH LUNGINFLAMMATION I SAMMA FIL (MEN SERPARAT FÖR REGION): 

import pandas as pd

def merge_data_for_countries(countries, output_file):

    # Läs in data från fasta filvägar
    df_amning = pd.read_csv("unicef_amning_data.csv")
    df_pneumonia = pd.read_csv("unicef_pneumonia_data.csv")
    
    # Filtrera amningsdata för de valda länderna
    filtered_amning = df_amning[df_amning['Geographic area'].isin(countries)]
    filtered_amning = filtered_amning[['Geographic area', 'Indicator', 'OBS_VALUE']]
    
    # Gruppera och beräkna medelvärdet för amningsdata
    aggregated_amning = filtered_amning.groupby(['Geographic area', 'Indicator'], as_index=False)['OBS_VALUE'].mean()
    
    # Filtrera pneumonidata för de valda länderna och Total-värden
    filtered_pneumonia = df_pneumonia[
        (df_pneumonia['Geographic area'].isin(countries)) &
        (df_pneumonia['Wealth Quintile'] == 'Total') &
        (df_pneumonia['Residence'] == 'Total') &
        (df_pneumonia["Mother's Education Level"] == 'Total')
    ]
    
    # Välj relevanta kolumner och byt namn på 'OBS_VALUE' i pneumonidata
    filtered_pneumonia = filtered_pneumonia[['Geographic area', 'OBS_VALUE']]
    filtered_pneumonia = filtered_pneumonia.rename(columns={'OBS_VALUE': 'Pneumonia_Value'})
    aggregated_pneumonia = filtered_pneumonia.groupby('Geographic area')['Pneumonia_Value'].mean().reset_index()
    
    # Slå ihop amnings- och pneumonidata
    merged_data = pd.merge(aggregated_amning, aggregated_pneumonia, on='Geographic area', how='left')
    
    # Spara den sammanslagna datan till en ny CSV-fil
    
    merged_data.to_csv(output_file, index=False)
    print(f"Ny CSV-fil med amningsdata och pneumonidata för valda länder har skapats: {output_file}")


#Kalla på funktionen, för respektive region: 

countries_southeastasia = [
    'Thailand', 'Indonesia', 'Viet Nam', 'Philippines', 'Myanmar', 
    'Cambodia', 'Timor-Leste', "Lao People's Democratic Republic"
]
merge_data_for_countries(countries_southeastasia, "asia_merged_amning_and_pneumonia_data.csv")


countries_centralafrica = [
    'Angola', 'Cameroon', 'Central African Republic', 'Chad', 'Congo',
    'Democratic Republic of the Congo','Equatorial Guinea','Gabon',
    'Sao Tome and Principe'
]
merge_data_for_countries(countries_centralafrica, "africa_merged_amning_and_pneumonia_data.csv")
